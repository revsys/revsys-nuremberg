{% extends base_template|default:"base.html" %}
{% load search_url django_vite i18n %}

{% block title %} Advanced Search {% endblock %}

{% block body_class %}document-search{% endblock %}

{% block extra_head_js %}
  <script type="module">
      import RefreshRuntime from 'http://localhost:5173/static/@react-refresh'
      RefreshRuntime.injectIntoGlobalHook(window)
      window.$RefreshReg$ = () => {}
      window.$RefreshSig$ = () => (type) => type
      window.__vite_plugin_react_preamble_installed__ = true
  </script>
  {% vite_asset 'src/vanilla/search.js' %}
{% endblock extra_head_js %}

{% block content %}
<section id="search" role="search" aria-label="Search the archive" class="theme-beige thin">
  <h1 class="h4">Search the archive &mdash; Advanced</h1>
  <div class="full-width">
    <div class="advanced-search-help">

      {% for message in messages %}
        {% if not message.extra_tags %}
        <div class="has-error">
        <p class="has-error">{{ message }}</p>
        </div>
        {% endif %}
      {% endfor %}

      <form class="advanced-search" role="search" aria-label="advanced search" action="{% url 'search:advanced' %}" method="POST">
        <p>{% trans 'Match all entered search terms below' %}</p>
        {% for field in form %}
          {% if field.name != 'evidence' and field.name != 'exhibit' and field.name != 'book' and '_' not in field.name %}
          <div class="{% if field.errors %}has-error{% endif %}">
          <p>{{ field.label_tag }} {{ field }}</p>
          {% for error in field.errors %}
          <p><small class="has-error">{{ error }}</small></p>
          {% endfor %}
          </div>
          {% endif %}
        {% endfor %}

          <div class="{% if form.evidence.errors %}has-error{% endif %}">
          <p>{{ form.evidence.label_tag }} {{ form.evidence }} {{ form.evidence_num }} {{ form.evidence_suffix }}</p>
          {% for error in form.evidence.errors %}
          <p><small class="has-error">{{ error }}</small></p>
          {% endfor %}
          </div>

          <div class="{% if form.exhibit.errors %}has-error{% endif %}">
          <p>{{ form.exhibit.label_tag }} {{ form.exhibit }} {{ form.exhibit_num }}</p>
          {% for error in form.exhibit.errors %}
          <p><small class="has-error">{{ error }}</small></p>
          {% endfor %}
          </div>

          <div class="{% if form.book.errors %}has-error{% endif %}">
          <p>{{ form.book.label_tag }} {{ form.book }} {{ form.book_num }}</p>
          {% for error in form.book.errors %}
          <p><small class="has-error">{{ error }}</small></p>
          {% endfor %}
          </div>

          <div class="{% if form.year_range.errors %}has-error{% endif %}">
          <p>{{ form.year_range.label_tag }} {{ form.year_range }}</p>
          {% for error in form.year_range.errors %}
          <p><small class="has-error">{{ error }}</small></p>
          {% endfor %}

          <div class="advanced-search-button-group">
            <button class="button search-button" type="submit">Advanced Search</button>
            <button class="button search-button" type="reset">Clear</button>
          </div>

      </form>

    </div>
  </div>
</section>
{% endblock %}
