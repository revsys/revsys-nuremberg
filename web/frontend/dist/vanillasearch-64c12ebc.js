let c=null,u=null;const h={lines:17,length:3,width:3,radius:10,scale:1,corners:1,color:"#9ec0c1",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:15,zIndex:2e9,className:"spinner",top:"50%",left:"40px",shadow:!1,hwaccel:!1,position:"absolute"},d=e=>{if(e.length)return Math.min(...e)},m=e=>{if(e.length)return Math.max(...e)};function p(e,t=300){let a;return(...n)=>{clearTimeout(a),a=setTimeout(()=>{e.apply(this,n)},t)}}const y=e=>{c&&(c.abort(),clearTimeout(u)),u=setTimeout(()=>{let t=$(".loading-indicator").removeClass("hide");t.find(".spinner").remove(),console.log("Setting spinner...."),new Spinner(h).spin(t[0]),$(".results-count").addClass("hide"),u=setTimeout(()=>{$("<a>").addClass("force-load").attr("href",e).text("This is taking unusually long. Click here to load results manually.").appendTo(t)},7e3)},100),c=$.ajax({url:e,data:{partial:!0}}),c.then(function(t){clearTimeout(u),c=null,u=null,$("main").html(t)}).fail(function(t,a){a!=="abort"&&(location.href=e)})},g=e=>{location.search!==e&&(history&&history.pushState&&history.pushState(void 0,void 0,e),y(e))},v=()=>{let e=document.getElementsByClassName("facet");Array.from(e).forEach(t=>{t.getElementsByClassName("collapse")[0].addEventListener("click",n=>{t.classList.toggle("collapsed")})})},E=()=>{let e=document.getElementsByClassName("facet");Array.from(e).forEach(t=>{let a=t.getElementsByClassName("show-all")[0];a&&a.addEventListener("click",n=>{console.log("Checked show all"),n.preventDefault(),t.classList.toggle("show-all");let f=t.getElementsByTagName("p");Array.from(f).forEach(r=>{r.classList.remove("hide")}),a.classList.add("hide")})})},T=()=>{let e=document.querySelector(".date-filter-form"),t=document.querySelector("input[name='year_min']"),a=document.querySelector("input[name='year_max']");if(!t||!a)return;if(!t.value||!a.value){let r=document.querySelectorAll(".facet p[data-year]"),l=[];Array.from(r).forEach(o=>{o.dataset.year&&l.push(o.dataset.year)});let i=d(l),s=m(l);t.value=i,a.value=s}const n=p(()=>{e.submit()},700);$(".date-slider").slider({range:!0,min:1898,max:1948,values:[$('input[name="year_min"]').val(),$('input[name="year_max"]').val()],slide:function(r,l){$('input[name="year_min"]').val(l.values[0]),$('input[name="year_max"]').val(l.values[1]),n()}}),document.getElementById("date-submit-button").addEventListener("click",r=>{if(r.preventDefault(),r.stopPropagation(),t.value<1895||t.value>1950||a.value<1895||a.value>1950){let s=t.value,o=a.value;t.value=d([m([s,1895]),1950]),a.value=d([m([o,1895]),1950])}if(t.value>a.value){let s=t.value,o=a.value;t.value=o,a.value=s,console.log("Flipping years")}let l=window.location.href,i="f=date_year:"+t.value+"-"+a.value;location.search&&location.search.indexOf("date_year")>-1?l=location.search.replace(/f=date_year:\d+-?\d+/,i):location.search.indexOf("?")>-1?l=location.search+"&"+i:l="?"+i,l=l.replace(/([\?&])page=\d+&?/,function(s,o){return o}),l="/search/new-search"+l,g(l)})},w=()=>{document.querySelector(".results-count").scrollIntoView()},x=e=>{let t=e.attr("action");return!t||t==location.pathname?(g("?"+e.serialize()),!1):!0},b=e=>e.ctrlKey||e.metaKey||e.button&&e.button==1,C=()=>{let e=document.getElementById("results-sort");e&&e.addEventListener("change",a=>{let n=a.target.value;window.location.href=n}),v(),T(),E();let t=document.querySelector("a.page-number");t&&t.addEventListener("click",w),$(document).on("submit","form",function(a){if(!b(a)){var n=$(this);return x(n)}})};document.addEventListener("DOMContentLoaded",C);
