const i=l=>{if(l.length)return Math.min(...l)},u=l=>{if(l.length)return Math.max(...l)};function d(l,e=300){let t;return(...o)=>{clearTimeout(t),t=setTimeout(()=>{l.apply(this,o)},e)}}const g=()=>{let l=document.getElementsByClassName("facet");Array.from(l).forEach(e=>{e.getElementsByClassName("collapse")[0].addEventListener("click",o=>{e.classList.toggle("collapsed")})})},v=()=>{let l=document.getElementsByClassName("facet");Array.from(l).forEach(e=>{let t=e.getElementsByClassName("show-all")[0];t&&t.addEventListener("click",o=>{o.preventDefault(),e.classList.toggle("show-all");let m=e.getElementsByTagName("p");Array.from(m).forEach(n=>{n.classList.remove("hide")}),t.classList.add("hide")})})},f=()=>{let l=document.querySelector(".date-filter-form"),e=document.querySelector("input[name='year_min']"),t=document.querySelector("input[name='year_max']");if(!e.value||!t.value){let n=document.querySelectorAll(".facet p[data-year]"),a=[];Array.from(n).forEach(r=>{r.dataset.year&&a.push(r.dataset.year)});let c=i(a),s=u(a);e.value=c,t.value=s}const o=d(()=>{l.submit()},700);$(".date-slider").slider({range:!0,min:1898,max:1948,values:[$('input[name="year_min"]').val(),$('input[name="year_max"]').val()],slide:function(n,a){$('input[name="year_min"]').val(a.values[0]),$('input[name="year_max"]').val(a.values[1]),o()}}),document.getElementById("date-submit-button").addEventListener("click",n=>{if(n.preventDefault(),n.stopPropagation(),e.value<1895||e.value>1950||t.value<1895||t.value>1950){let s=e.value,r=t.value;e.value=i([u([s,1895]),1950]),t.value=i([u([r,1895]),1950])}if(e.value>t.value){let s=e.value,r=t.value;e.value=r,t.value=s,console.log("Flipping years")}let a=window.location.href,c="f=date_year:"+e.value+"-"+t.value;location.search&&location.search.indexOf("date_year")>-1?a=location.search.replace(/f=date_year:\d+-?\d+/,c):location.search.indexOf("?")>-1?a=location.search+"&"+c:a="?"+c,a=a.replace(/([\?&])page=\d+&?/,function(s,r){return r}),a="/search/new-search"+a,console.log(a),window.location.href=a})},y=()=>{document.getElementById("results-sort").addEventListener("change",e=>{let t=e.target.value;window.location.href=t}),g(),f(),v()};document.addEventListener("DOMContentLoaded",y);
