let u=null,c=null;const p={lines:17,length:3,width:3,radius:10,scale:1,corners:1,color:"#9ec0c1",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:15,zIndex:2e9,className:"spinner",top:"50%",left:"40px",shadow:!1,hwaccel:!1,position:"absolute"},d=t=>{if(t.length)return Math.min(...t)},m=t=>{if(t.length)return Math.max(...t)};function h(t,e=300){let a;return(...r)=>{clearTimeout(a),a=setTimeout(()=>{t.apply(this,r)},e)}}const y=t=>{u&&(u.abort(),clearTimeout(c)),c=setTimeout(()=>{let e=$(".loading-indicator").removeClass("hide");e.find(".spinner").remove(),console.log("Setting spinner...."),new Spinner(p).spin(e[0]),$(".results-count").addClass("hide"),c=setTimeout(()=>{$("<a>").addClass("force-load").attr("href",t).text("This is taking unusually long. Click here to load results manually.").appendTo(e)},7e3)},100),u=$.ajax({url:t,data:{partial:!0}}),u.then(function(e){clearTimeout(c),u=null,c=null,$("main").html(e)}).fail(function(e,a){a!=="abort"&&(location.href=t)})},g=t=>{location.search!==t&&(history&&history.pushState&&history.pushState(void 0,void 0,t),y(t))},v=()=>{let t=document.getElementsByClassName("facet");Array.from(t).forEach(e=>{e.getElementsByClassName("collapse")[0].addEventListener("click",r=>{e.classList.toggle("collapsed")})})},E=()=>{let t=document.getElementsByClassName("facet");Array.from(t).forEach(e=>{let a=e.getElementsByClassName("show-all")[0];a&&a.addEventListener("click",r=>{r.preventDefault(),e.classList.toggle("show-all");let f=e.getElementsByTagName("p");Array.from(f).forEach(o=>{o.classList.remove("hide")}),a.classList.add("hide")})})},x=()=>{let t=document.querySelector(".date-filter-form"),e=document.querySelector("input[name='year_min']"),a=document.querySelector("input[name='year_max']");if(!e.value||!a.value){let o=document.querySelectorAll(".facet p[data-year]"),l=[];Array.from(o).forEach(n=>{n.dataset.year&&l.push(n.dataset.year)});let i=d(l),s=m(l);e.value=i,a.value=s}const r=h(()=>{t.submit()},700);$(".date-slider").slider({range:!0,min:1898,max:1948,values:[$('input[name="year_min"]').val(),$('input[name="year_max"]').val()],slide:function(o,l){$('input[name="year_min"]').val(l.values[0]),$('input[name="year_max"]').val(l.values[1]),r()}}),document.getElementById("date-submit-button").addEventListener("click",o=>{if(o.preventDefault(),o.stopPropagation(),e.value<1895||e.value>1950||a.value<1895||a.value>1950){let s=e.value,n=a.value;e.value=d([m([s,1895]),1950]),a.value=d([m([n,1895]),1950])}if(e.value>a.value){let s=e.value,n=a.value;e.value=n,a.value=s,console.log("Flipping years")}let l=window.location.href,i="f=date_year:"+e.value+"-"+a.value;location.search&&location.search.indexOf("date_year")>-1?l=location.search.replace(/f=date_year:\d+-?\d+/,i):location.search.indexOf("?")>-1?l=location.search+"&"+i:l="?"+i,l=l.replace(/([\?&])page=\d+&?/,function(s,n){return n}),l="/search/new-search"+l,g(l)})},T=()=>{document.querySelector(".results-count").scrollIntoView()},b=t=>{let e=t.attr("action");return!e||e==location.pathname?(g("?"+t.serialize()),!1):!0},w=t=>t.ctrlKey||t.metaKey||t.button&&t.button==1,S=()=>{document.getElementById("results-sort").addEventListener("change",e=>{let a=e.target.value;window.location.href=a}),v(),x(),E(),document.querySelector("a.page-number").addEventListener("click",T),$(document).on("submit","form",function(e){if(!w(e)){var a=$(this);return b(a)}})};document.addEventListener("DOMContentLoaded",S);
