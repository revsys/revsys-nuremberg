let c=null,u=null;const g={lines:17,length:3,width:3,radius:10,scale:1,corners:1,color:"#9ec0c1",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:15,zIndex:2e9,className:"spinner",top:"50%",left:"40px",shadow:!1,hwaccel:!1,position:"absolute"},d=t=>{if(t.length)return Math.min(...t)},m=t=>{if(t.length)return Math.max(...t)};function h(t,e=300){let a;return(...o)=>{clearTimeout(a),a=setTimeout(()=>{t.apply(this,o)},e)}}const p=t=>{c&&(c.abort(),clearTimeout(u)),u=setTimeout(()=>{let e=$(".loading-indicator").removeClass("hide");e.find(".spinner").remove(),console.log("Setting spinner...."),new Spinner(g).spin(e[0]),$(".results-count").addClass("hide"),u=setTimeout(()=>{$("<a>").addClass("force-load").attr("href",t).text("This is taking unusually long. Click here to load results manually.").appendTo(e)},7e3)},100),c=$.ajax({url:t,data:{partial:!0}}),c.then(function(e){clearTimeout(u),c=null,u=null,$("main").html(e)}).fail(function(e,a){a!=="abort"&&(location.href=t)})},y=t=>{location.search!==t&&(history&&history.pushState&&history.pushState(void 0,void 0,t),p(t))},v=()=>{let t=document.getElementsByClassName("facet");Array.from(t).forEach(e=>{e.getElementsByClassName("collapse")[0].addEventListener("click",o=>{e.classList.toggle("collapsed")})})},E=()=>{let t=document.getElementsByClassName("facet");Array.from(t).forEach(e=>{let a=e.getElementsByClassName("show-all")[0];a&&a.addEventListener("click",o=>{console.log("Checked show all"),o.preventDefault(),e.classList.toggle("show-all");let f=e.getElementsByTagName("p");Array.from(f).forEach(r=>{r.classList.remove("hide")}),a.classList.add("hide")})})},T=()=>{let t=document.querySelector(".date-filter-form"),e=document.querySelector("input[name='year_min']"),a=document.querySelector("input[name='year_max']");if(!e||!a)return;if(!e.value||!a.value){let r=document.querySelectorAll(".facet p[data-year]"),l=[];Array.from(r).forEach(n=>{if(n.dataset.year){if(n.dataset.year==0){console.log("Skipping 0 year");return}l.push(n.dataset.year)}});let i=d(l),s=m(l);e.value=i,a.value=s}const o=h(()=>{t.submit()},700);$(".date-slider").slider({range:!0,min:1793,max:1948,values:[$('input[name="year_min"]').val(),$('input[name="year_max"]').val()],slide:function(r,l){$('input[name="year_min"]').val(l.values[0]),$('input[name="year_max"]').val(l.values[1]),o()}}),document.getElementById("date-submit-button").addEventListener("click",r=>{if(r.preventDefault(),r.stopPropagation(),e.value<1793||e.value>2015||a.value<1793||a.value>2015){let s=e.value,n=a.value;e.value=d([m([s,1793]),2015]),a.value=d([m([n,1793]),2015])}if(e.value>a.value){let s=e.value,n=a.value;e.value=n,a.value=s,console.log("Flipping years")}let l=window.location.href,i="f=date_year:"+e.value+"-"+a.value;location.search&&location.search.indexOf("date_year")>-1?l=location.search.replace(/f=date_year:\d+-?\d+/,i):location.search.indexOf("?")>-1?l=location.search+"&"+i:l="?"+i,l=l.replace(/([\?&])page=\d+&?/,function(s,n){return n}),l="/search/new-search"+l,y(l)})},w=()=>{document.querySelector(".results-count").scrollIntoView()},x=()=>{let t=document.getElementById("search-bar-clear"),e=document.getElementById("search-query");t&&t.addEventListener("click",a=>{a.preventDefault(),e.value=""})},S=()=>{let t=document.getElementById("results-sort");t&&t.addEventListener("change",a=>{let o=a.target.value;window.location.href=o}),v(),T(),E();let e=document.querySelector("a.page-number");e&&e.addEventListener("click",w),x()};document.addEventListener("DOMContentLoaded",S);
